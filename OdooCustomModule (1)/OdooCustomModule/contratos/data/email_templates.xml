
<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- Plantilla de notificaci√≥n de vencimiento (2 meses antes) -->
        <record id="email_template_contract_expiry_warning" model="mail.template">
            <field name="name">Contrato - Aviso de Vencimiento (2 meses)</field>
            <field name="model_id" ref="model_contract_general"/>
            <field name="subject">‚ö†Ô∏è Contrato ${object.name} vence en 2 meses - ${object.partner_id.name}</field>
            <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
            <field name="email_to">${object.contract_manager_id.email}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F2F3; font-family: Arial, sans-serif; color: #454748; width: 100%; border-collapse: separate;">
        <tr>
            <td align="center">
                <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #454748; border-collapse: separate;">
                    <tbody>
                        <!-- Encabezado -->
                        <tr>
                            <td align="center" style="min-height: 120px; padding: 20px 0;">
                                <div style="background: linear-gradient(135deg, #FF9800, #F57C00); padding: 20px; border-radius: 10px; color: white;">
                                    <h1 style="margin: 0; font-size: 24px;">‚ö†Ô∏è AVISO DE VENCIMIENTO</h1>
                                    <p style="margin: 10px 0 0 0; font-size: 16px;">Su contrato vence en 2 meses</p>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Contenido principal -->
                        <tr>
                            <td style="padding: 20px;">
                                <h2 style="color: #2E7D32; margin-bottom: 20px;">Estimado/a ${object.contract_manager_id.name},</h2>
                                
                                <p>Le recordamos que el siguiente contrato vencer√° en aproximadamente <strong>2 meses</strong>:</p>
                                
                                <div style="background: #FFF3E0; border-left: 4px solid #FF9800; padding: 15px; margin: 20px 0;">
                                    <h3 style="margin-top: 0; color: #E65100;">Informaci√≥n del Contrato</h3>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>N√∫mero:</strong> ${object.name}</li>
                                        <li><strong>Cliente:</strong> ${object.partner_id.name}</li>
                                        <li><strong>Representante Legal:</strong> ${object.legal_representative_name}</li>
                                        <li><strong>Tipo:</strong> ${object.contract_type_id.name}</li>
                                        <li><strong>Fecha de Vencimiento:</strong> ${object.date_end}</li>
                                        <li><strong>Valor Mensual:</strong> ${object.currency_id.symbol} ${'{:,.2f}'.format(object.monthly_fee or 0)}</li>
                                        <li><strong>Valor Total:</strong> ${object.currency_id.symbol} ${'{:,.2f}'.format(object.contract_value)}</li>
                                    </ul>
                                </div>
                                
                                % if object.auto_renewal:
                                <div style="background: #E8F5E8; border-left: 4px solid #4CAF50; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #2E7D32;">‚úÖ Renovaci√≥n Autom√°tica Activada</h4>
                                    <p style="margin-bottom: 0;">Este contrato se renovar√° autom√°ticamente por ${object.duration_months} meses adicionales.</p>
                                </div>
                                % else:
                                <div style="background: #FFEBEE; border-left: 4px solid #F44336; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #C62828;">‚ö†Ô∏è Renovaci√≥n Manual Requerida</h4>
                                    <p style="margin-bottom: 0;">Este contrato NO se renovar√° autom√°ticamente. Debe coordinar la renovaci√≥n antes del vencimiento.</p>
                                </div>
                                % endif
                                
                                <h3 style="color: #2E7D32;">Acciones Sugeridas:</h3>
                                <ul>
                                    <li>Contactar al cliente para confirmar la renovaci√≥n</li>
                                    <li>Revisar t√©rminos y condiciones actuales</li>
                                    <li>Actualizar informaci√≥n de contacto si es necesario</li>
                                    <li>Coordinar cualquier cambio en servicios o tarifas</li>
                                </ul>
                                
                                <div style="text-align: center; margin: 30px 0;">
                                    <a href="${ctx.get('base_url', '')}/web#id=${object.id}&amp;view_type=form&amp;model=contract.general" 
                                       style="background: #2E7D32; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block;">
                                        Ver Contrato en Odoo
                                    </a>
                                </div>
                                
                                <p>Este es un recordatorio autom√°tico. Para m√°s informaci√≥n, acceda al sistema o contacte al departamento correspondiente.</p>
                                
                                <p>Saludos cordiales,<br/>
                                Sistema de Gesti√≥n de Contratos<br/>
                                ${object.company_id.name}</p>
                            </td>
                        </tr>
                        
                        <!-- Pie de p√°gina -->
                        <tr>
                            <td style="text-align: center; padding: 16px; color: #8a8a8a; font-size: 12px;">
                                <p>Este correo fue enviado autom√°ticamente por el sistema de gesti√≥n de contratos.</p>
                                <p>No responda a este mensaje.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>
</div>
            </field>
        </record>
        
        <!-- Plantilla de notificaci√≥n de vencimiento (d√≠a del vencimiento) -->
        <record id="email_template_contract_expiry" model="mail.template">
            <field name="name">Contrato - Vencimiento Hoy</field>
            <field name="model_id" ref="model_contract_general"/>
            <field name="subject">üö® URGENTE: Contrato ${object.name} vence HOY - ${object.partner_id.name}</field>
            <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
            <field name="email_to">${object.contract_manager_id.email}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F2F3; font-family: Arial, sans-serif; color: #454748; width: 100%; border-collapse: separate;">
        <tr>
            <td align="center">
                <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #454748; border-collapse: separate;">
                    <tbody>
                        <!-- Encabezado urgente -->
                        <tr>
                            <td align="center" style="min-height: 120px; padding: 20px 0;">
                                <div style="background: linear-gradient(135deg, #F44336, #D32F2F); padding: 20px; border-radius: 10px; color: white; animation: pulse 2s infinite;">
                                    <h1 style="margin: 0; font-size: 28px;">üö® VENCIMIENTO HOY</h1>
                                    <p style="margin: 10px 0 0 0; font-size: 18px; font-weight: bold;">ACCI√ìN INMEDIATA REQUERIDA</p>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Contenido principal -->
                        <tr>
                            <td style="padding: 20px;">
                                <h2 style="color: #D32F2F; margin-bottom: 20px;">URGENTE - ${object.contract_manager_id.name},</h2>
                                
                                <p><strong>El siguiente contrato VENCE HOY (${object.date_end}):</strong></p>
                                
                                <div style="background: #FFEBEE; border: 2px solid #F44336; padding: 20px; margin: 20px 0; border-radius: 8px;">
                                    <h3 style="margin-top: 0; color: #D32F2F;">üìã Informaci√≥n del Contrato</h3>
                                    <ul style="margin-bottom: 0; line-height: 1.8;">
                                        <li><strong>N√∫mero:</strong> ${object.name}</li>
                                        <li><strong>Cliente:</strong> ${object.partner_id.name}</li>
                                        <li><strong>Representante:</strong> ${object.legal_representative_name}</li>
                                        <li><strong>Tel√©fono Cliente:</strong> ${object.partner_id.phone}</li>
                                        <li><strong>Email Cliente:</strong> ${object.partner_id.email}</li>
                                        <li><strong>Valor Total:</strong> ${object.currency_id.symbol} ${'{:,.2f}'.format(object.contract_value)}</li>
                                    </ul>
                                </div>
                                
                                <div style="background: #FFF3E0; border-left: 4px solid #FF9800; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #E65100;">‚è∞ ACCIONES INMEDIATAS REQUERIDAS:</h4>
                                    <ol>
                                        <li><strong>Contactar al cliente INMEDIATAMENTE</strong></li>
                                        <li><strong>Confirmar renovaci√≥n o terminaci√≥n del servicio</strong></li>
                                        <li><strong>Actualizar el estado del contrato en el sistema</strong></li>
                                        <li><strong>Coordinar continuidad del servicio si aplica</strong></li>
                                    </ol>
                                </div>
                                
                                % if object.auto_renewal:
                                <div style="background: #E8F5E8; border-left: 4px solid #4CAF50; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #2E7D32;">‚úÖ Renovaci√≥n Autom√°tica</h4>
                                    <p style="margin-bottom: 0;">Este contrato se renovar√° autom√°ticamente. Verifique que todo est√© en orden para la renovaci√≥n.</p>
                                </div>
                                % else:
                                <div style="background: #FFEBEE; border: 2px solid #F44336; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #D32F2F;">üö® SIN RENOVACI√ìN AUTOM√ÅTICA</h4>
                                    <p style="margin-bottom: 0; font-weight: bold;">Este contrato NO se renovar√° autom√°ticamente. El servicio se suspender√° si no se renueva manualmente HOY.</p>
                                </div>
                                % endif
                                
                                <div style="text-align: center; margin: 30px 0;">
                                    <a href="${ctx.get('base_url', '')}/web#id=${object.id}&amp;view_type=form&amp;model=contract.general" 
                                       style="background: #D32F2F; color: white; padding: 15px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-size: 16px; font-weight: bold;">
                                        ABRIR CONTRATO AHORA
                                    </a>
                                </div>
                                
                                <p style="color: #D32F2F; font-weight: bold;">Este contrato requiere atenci√≥n inmediata. No ignore este mensaje.</p>
                                
                                <p>Sistema de Gesti√≥n de Contratos<br/>
                                ${object.company_id.name}<br/>
                                Fecha: ${ctx.get('date_today', 'Hoy')}</p>
                            </td>
                        </tr>
                        
                        <!-- Pie de p√°gina -->
                        <tr>
                            <td style="text-align: center; padding: 16px; background: #FFEBEE; color: #D32F2F; font-size: 12px; font-weight: bold;">
                                <p>‚ö†Ô∏è NOTIFICACI√ìN URGENTE - ACCI√ìN INMEDIATA REQUERIDA ‚ö†Ô∏è</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>
</div>
            </field>
        </record>
        
        <!-- Plantilla de notificaci√≥n de renovaci√≥n -->
        <record id="email_template_contract_renewal" model="mail.template">
            <field name="name">Contrato - Confirmaci√≥n de Renovaci√≥n</field>
            <field name="model_id" ref="model_contract_general"/>
            <field name="subject">‚úÖ Contrato ${object.name} renovado exitosamente - ${object.partner_id.name}</field>
            <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
            <field name="email_to">${object.contract_manager_id.email}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F2F3; font-family: Arial, sans-serif; color: #454748; width: 100%; border-collapse: separate;">
        <tr>
            <td align="center">
                <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #454748; border-collapse: separate;">
                    <tbody>
                        <!-- Encabezado de √©xito -->
                        <tr>
                            <td align="center" style="min-height: 120px; padding: 20px 0;">
                                <div style="background: linear-gradient(135deg, #4CAF50, #2E7D32); padding: 20px; border-radius: 10px; color: white;">
                                    <h1 style="margin: 0; font-size: 24px;">‚úÖ CONTRATO RENOVADO</h1>
                                    <p style="margin: 10px 0 0 0; font-size: 16px;">Renovaci√≥n exitosa</p>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Contenido principal -->
                        <tr>
                            <td style="padding: 20px;">
                                <h2 style="color: #2E7D32; margin-bottom: 20px;">Estimado/a ${object.contract_manager_id.name},</h2>
                                
                                <p>Le confirmamos que el siguiente contrato ha sido <strong>renovado exitosamente</strong>:</p>
                                
                                <div style="background: #E8F5E8; border-left: 4px solid #4CAF50; padding: 20px; margin: 20px 0; border-radius: 5px;">
                                    <h3 style="margin-top: 0; color: #2E7D32;">üìã Informaci√≥n del Contrato Renovado</h3>
                                    <ul style="margin-bottom: 0; line-height: 1.8;">
                                        <li><strong>N√∫mero:</strong> ${object.name}</li>
                                        <li><strong>Cliente:</strong> ${object.partner_id.name}</li>
                                        <li><strong>Representante Legal:</strong> ${object.legal_representative_name}</li>
                                        <li><strong>Fecha de Renovaci√≥n:</strong> ${object.last_renewal_date}</li>
                                        <li><strong>Nueva Fecha de Vencimiento:</strong> ${object.date_end}</li>
                                        <li><strong>N√∫mero de Renovaciones:</strong> ${object.renewal_count}</li>
                                        <li><strong>Duraci√≥n:</strong> ${object.duration_months} meses adicionales</li>
                                    </ul>
                                </div>
                                
                                <div style="background: #F3E5F5; border-left: 4px solid #9C27B0; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #7B1FA2;">üí∞ Informaci√≥n Financiera</h4>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>Valor Total:</strong> ${object.currency_id.symbol} ${'{:,.2f}'.format(object.contract_value)}</li>
                                        % if object.monthly_fee:
                                        <li><strong>Tarifa Mensual:</strong> ${object.currency_id.symbol} ${'{:,.2f}'.format(object.monthly_fee)}</li>
                                        % endif
                                        <li><strong>Ciclo de Facturaci√≥n:</strong> ${dict(object._fields['billing_cycle'].selection)[object.billing_cycle]}</li>
                                    </ul>
                                </div>
                                
                                <h3 style="color: #2E7D32;">üìù Pr√≥ximos Pasos:</h3>
                                <ul>
                                    <li>El servicio contin√∫a sin interrupciones</li>
                                    <li>Se mantendr√°n las mismas condiciones contractuales</li>
                                    <li>La facturaci√≥n continuar√° seg√∫n el ciclo establecido</li>
                                    <li>Se programar√° el pr√≥ximo recordatorio de vencimiento</li>
                                </ul>
                                
                                <div style="background: #FFF3E0; border-left: 4px solid #FF9800; padding: 15px; margin: 20px 0;">
                                    <h4 style="margin-top: 0; color: #E65100;">üìÖ Recordatorio</h4>
                                    <p style="margin-bottom: 0;">Se enviar√° el pr√≥ximo aviso de vencimiento 2 meses antes de la nueva fecha de vencimiento (${object.date_end}).</p>
                                </div>
                                
                                <div style="text-align: center; margin: 30px 0;">
                                    <a href="${ctx.get('base_url', '')}/web#id=${object.id}&amp;view_type=form&amp;model=contract.general" 
                                       style="background: #2E7D32; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block;">
                                        Ver Contrato Renovado
                                    </a>
                                </div>
                                
                                <p>Si tiene alguna pregunta sobre esta renovaci√≥n, por favor contacte al departamento correspondiente.</p>
                                
                                <p>Saludos cordiales,<br/>
                                Sistema de Gesti√≥n de Contratos<br/>
                                ${object.company_id.name}</p>
                            </td>
                        </tr>
                        
                        <!-- Pie de p√°gina -->
                        <tr>
                            <td style="text-align: center; padding: 16px; background: #E8F5E8; color: #2E7D32; font-size: 12px;">
                                <p>‚úÖ Renovaci√≥n procesada autom√°ticamente por el sistema</p>
                                <p>Fecha de procesamiento: ${ctx.get('date_today', 'Hoy')}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>
</div>
            </field>
        </record>
    </data>
</odoo>
